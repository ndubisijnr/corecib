{"remainingRequest":"/Users/clark/Desktop/business.corestep.com/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/clark/Desktop/business.corestep.com/src/components/form/PaybillsForm.vue?vue&type=style&index=0&id=1f8c8a9a&scoped=true&lang=css&","dependencies":[{"path":"/Users/clark/Desktop/business.corestep.com/src/components/form/PaybillsForm.vue","mtime":1684628079222},{"path":"/Users/clark/Desktop/business.corestep.com/node_modules/css-loader/dist/cjs.js","mtime":1670880042824},{"path":"/Users/clark/Desktop/business.corestep.com/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":1670880044043},{"path":"/Users/clark/Desktop/business.corestep.com/node_modules/postcss-loader/src/index.js","mtime":1670880043297},{"path":"/Users/clark/Desktop/business.corestep.com/node_modules/cache-loader/dist/cjs.js","mtime":1670880017776},{"path":"/Users/clark/Desktop/business.corestep.com/node_modules/vue-loader/lib/index.js","mtime":1670880044043}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ci5mb3JtewogIGhlaWdodDogYXV0bzsKICB3aWR0aDogMTAwJTsKICBiYWNrZ3JvdW5kLWNvbG9yOiAjRkZGRkZGOwogIGJveC1zaGFkb3c6MCAwIDFyZW0gMCByZ2IoMTM2IDE1MiAxNzAgLyAxNSUpOwogIGJvcmRlci1yYWRpdXM6IGNhbGMoMC4zNzVyZW0gLSAxcHgpIGNhbGMoMC4zNzVyZW0gLSAxcHgpIDAgMDsKCn0KLmNhcmQtaGVhZGVyewogIGRpc3BsYXk6IGZsZXg7CiAganVzdGlmeS1jb250ZW50OiBzcGFjZS1iZXR3ZWVuOwogIGFsaWduLWl0ZW1zOiBjZW50ZXI7Cn0KQG1lZGlhIChtYXgtd2lkdGg6IDk5OXB4KSB7CiAgLmZvcm17CiAgICBoZWlnaHQ6IGF1dG87CiAgICB3aWR0aDogMTAwJTsKICAgIGJhY2tncm91bmQtY29sb3I6ICNGRkZGRkY7CiAgICBib3gtc2hhZG93OjAgMCAxcmVtIDAgcmdiKDEzNiAxNTIgMTcwIC8gMTUlKTsKICAgIGJvcmRlci1yYWRpdXM6IGNhbGMoMC4zNzVyZW0gLSAxcHgpIGNhbGMoMC4zNzVyZW0gLSAxcHgpIDAgMDsKCiAgfQp9Cg=="},{"version":3,"sources":["PaybillsForm.vue"],"names":[],"mappings":";AAiRA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA","file":"PaybillsForm.vue","sourceRoot":"src/components/form","sourcesContent":["<template>\n    <div class=\"form\">\n      <div class=\"card-header\">\n        <img :src=\"billerImage\" width=\"40\" />\n      </div>\n      <!-- handle Cable TV, Electricity and Betting payment  -->\n        <div v-if=\"products[0].productBillerCode.includes('CABLE') || products[0].productBillerCode.includes('ELECTRIC') || products[0].productBillerCode.includes('BET')\">\n\n          <!-- handles customer enquiry  -->\n          <form @submit.prevent=\"customerEnq(product_code = products[0].productBillerCode)\">\n          <div class=\"card-body\">\n            <div>\n                  <!-- Smart card number and meter number -->\n                  <label v-if=\"products[0].productBillerCode.includes('CABLE') || products[0].productBillerCode.includes('ELECTRIC')\" class=\"small\">{{products[0].productBillerCode.includes('CABLE') ? 'Smart Card Number' : 'Meter Number' }}</label>\n                  <label v-else class=\"small\">Account ID</label>\n                  <b-input v-if=\"products[0].productBillerCode.includes('CABLE') || products[0].productBillerCode.includes('ELECTRIC')\" type=\"number\" :placeholder=\"products[0].productBillerCode.includes('ELECTRIC') ? 'Enter your meter number' :'Enter your smart card number'\" id=\"smartcardInput\" v-model=\"customerEnqModel.billerCustomerId\" :disabled=\"!Object.values(customerEnquiryData).every((o) => o === null)\" required></b-input>\n                  <b-input v-else type=\"number\" placeholder=\"Enter your Account Id number\" id=\"smartcardInput\" v-model=\"customerEnqModel.billerCustomerId\" :disabled=\"!Object.values(customerEnquiryData).every((o) => o === null)\" required></b-input>\n                  <span class=\"small\" v-if=\"!Object.values(customerEnquiryData).every((o) => o === null)\"><span class=\"small\">Customer:</span> <b>{{ customerEnquiryData.customerName }}</b> <br><span @click=\"clearEnq()\"><span class=\"text-primary\" style=\"cursor: pointer\">Not me?</span></span></span>\n            </div>\n            <p class=\"small text-danger\" id=\"err\"></p> <!-- shows customer enquiry error -->\n            <!-- end of customer enquiry area -->\n\n\n            <div v-if=\"!Object.values(customerEnquiryData).every((o) => o === null)\">\n              <div v-if=\"products[0].productBillerCode.includes('CABLE') || products[0].productBillerCode.includes('ELECTRIC')\">\n              <div v-if=\"products[0].productPrice !== 'VARIABLE'\">\n                <label class=\"small\">Select Plan</label>\n                <b-select v-if=\"products[0].productBillerCode.includes('CABLE') || products[0].productBillerCode.includes('DATA')\" v-model=\"productpaymentModdel.productCode\" required>\n                  <b-select-option  v-for=\"i in products\" :key=\"i\" :value=\"i.productPrice + ' ' + i.productCode\">{{i.productDescription}} @ {{i.productPrice | formatAmount}}</b-select-option>\n                </b-select>\n                <b-select v-else v-model=\"productpaymentModdel.productCode\">\n                  <b-select-option  v-for=\"i in products\" :key=\"i\" :value=\"i.productCode\">{{i.productCode}} @ {{i.productPrice | formatAmount}}</b-select-option>\n                </b-select>\n              </div>\n              <div v-if=\"products[0].productPrice === 'VARIABLE'\">\n                <div>\n                <label class=\"small\">Amount</label>\n                <b-input type=\"number\" required class=\"mb-2\" v-model=\"productpaymentModdel.amount\" />\n                </div>\n                <div>\n              <label class=\"small\">Select Option</label>\n              <b-select v-model=\"productpaymentModdel.productCode\">\n                <b-select-option  v-for=\"i in products\" :key=\"i\" :value=\"i.productCode\">{{i.productCode.replace('_', ' ') | titleCase}}</b-select-option>\n              </b-select>\n                </div>\n              </div>\n              <div class=\"mt-2\">\n                <label class=\"small\">Email</label>\n                <b-input type=\"email\" :value=\"currentOrganisation.organisationEmail\" id=\"organisationEmail\"></b-input>\n              </div>\n              <h6 class=\"small m-1\" v-if=\"products[0].productBillerCode.includes('ELECTRIC')\">Token will be sent to your email on successful purchase</h6>\n            </div>\n\n              <!-- Betting -->\n              <div v-if=\"products[0].productBillerCode.includes('BET')\">\n                <div>\n                  <label class=\"small\">Amount</label>\n                  <b-input type=\"number\" required class=\"mb-2\" v-model=\"productpaymentModdel.amount\">\n                  </b-input>\n                </div>\n                <div>\n                  <label class=\"small\">Select Plan</label>\n                  <b-select v-model=\"productpaymentModdel.productCode\" >\n                    <b-select-option  v-for=\"i in products\" :key=\"i\" :value=\"i.productCode\">{{i.productDescription}}</b-select-option>\n                  </b-select>\n                </div>\n                <div class=\"mt-2\">\n                  <label class=\"small\">Email</label>\n                  <b-input type=\"email\" :value=\"currentOrganisation.organisationEmail\" id=\"organisationEmail\"></b-input>\n                </div>\n              </div>\n              <!-- end of betting -->\n\n            </div>\n          </div>\n            <div class=\"card-footer\">\n              <b-button class=\"mt-2 w-100\" v-if=\"!Object.values(customerEnquiryData).every((o) => o === null)\" type=\"submit\" @click=\"action = 'pay'\" style=\"background-color:#413d52;color:white\" :disabled=\"paymentLoading\">{{paymentLoading ? 'Please Wait...' : 'Pay'}}</b-button>\n              <b-button class=\"mt-2 w-100\" v-else type=\"submit\" style=\"background-color:#413d52;color:white\" :disabled=\"customerEnquiryLoading\" @click=\"action = 'validate'\">{{customerEnquiryLoading ? 'Please Wait...' : 'Validate'}}</b-button>\n                </div>\n          </form>\n        </div>\n      <!-- end handle Cable TV, Electricity and Betting payment -->\n\n      <!-- handle AIRTIME and DATA purchase -->\n        <form @submit.prevent=\"payment(obj = productCode)\" v-if=\"products[0].productBillerCode.includes('AIRTIME') || products[0].productBillerCode.includes('DATA')\">\n          <div class=\"card-body\">\n                <div class=\"mb-2\"  v-for=\"i in products\" :key=\"i\">\n                  <div v-if=\"i.productBillerCode.includes('AIRTIME')\">\n                  <div>\n                    <!-- area for AIRTIME -->\n                      <div v-for=\"i in products\" :key=\"i\">\n                        <div>\n                          <label class=\"small\">{{billerCustomerIdInputLabel}}</label>\n                          <b-input type=\"tell\" required class=\"mb-2\"\n                                   v-model=\"productpaymentModdel.billerCustomerId\" placeholder=\"Enter mobile number\">\n                          </b-input>\n                        </div>\n                        <div v-if=\"i.productPrice == 'VARIABLE'\">\n                          <div>\n                            <label class=\"small\">Amount</label>\n                            <b-input type=\"number\" required class=\"mb-2\" v-model=\"productpaymentModdel.amount\">\n                            </b-input>\n                          </div>\n                        </div>\n                        <div class=\"mt-2\">\n                          <label class=\"small\">Email</label>\n                          <b-input type=\"email\" :value=\"currentOrganisation.organisationEmail\" id=\"organisationEmail\"></b-input>\n                        </div>\n                      </div>\n                  </div>\n                  </div>\n\n                </div>\n          <!-- end area for AIRTIME -->\n\n          <!-- Area for DATA BUNDLE -->\n              <div v-if=\"products[0].productBillerCode.includes('DATA')\">\n                <div>\n                  <label class=\"small\">{{billerCustomerIdInputLabel ? billerCustomerIdInputLabel : 'Betting Wallet'}}</label>\n                  <b-input type=\"tell\" required class=\"mb-2\"\n                           v-model=\"productpaymentModdel.billerCustomerId\" :placeholder=\"billerCustomerIdInputLabel ? `${billerCustomerIdInputLabel}`: 'Betting Wallet'\">\n                  </b-input>\n                </div>\n                <div>\n                  <div v-if=\"products[0].productBillerCode.includes('DATA')\">\n                    <label class=\"small\">Select Plan</label>\n                    <b-select v-model=\"productpaymentModdel.productCode\" >\n                       <b-select-option  v-for=\"i in products\" :key=\"i\" :value=\"i.productPrice + ' ' + i.productCode\">{{i.productDescription}} @ {{i.productPrice | formatAmount}}</b-select-option>\n                    </b-select>\n                    <div class=\"mt-2\">\n                      <label class=\"small\">Email</label>\n                      <b-input type=\"email\" :value=\"currentOrganisation.organisationEmail\" id=\"organisationEmail\"></b-input>\n                    </div>\n                  </div>\n                </div>\n            </div>\n\n          </div>\n\n          <div class=\"card-footer\">\n            <b-button class=\"mt-2 w-100\" type=\"submit\" style=\"background-color:#413d52;color:white\" :disabled=\"paymentLoading\">{{paymentLoading ? 'Please Wait...' : 'Proceed'}}</b-button>\n          </div>\n        </form>\n      <!-- End Area for DATA BUNDLE -->\n    </div>\n</template>\n\n<script>\nimport {mapState} from \"vuex\";\nimport StoreUtils from \"@/util/baseUtils/StoreUtils\";\nimport BillsPaymentRequest from \"@/model/request/BillsPaymentRequest\";\nimport AuthenticationResponse from \"@/model/reponse/AuthenticationResponse\";\n\nexport default {\n  name: \"PaybillsForm\",\n  data(){\n    return{\n      productpaymentModdel:BillsPaymentRequest.productPayment,\n      customerEnqModel:BillsPaymentRequest.customerEnquiry,\n      action:null,\n      code:this.productCode,\n      emailModel:AuthenticationResponse.organisation\n    }\n  },\n\n  props:{\n    billerCustomerIdInputLabel: String,\n    productBillerCode:String,\n    productCode:String,\n    productPrice:String,\n    billerImage:String,\n\n  },\n  methods:{\n    customerEnq(product_code, action){\n      //checks if users is using the validate\n      if(this.action == 'validate'){\n        this.customerEnqModel.billerCode = product_code\n        StoreUtils.dispatch(StoreUtils.actions.billspayment.updateCustomerEnq, this.customerEnqModel).then(() => {\n          if(this.error_msg == '00'){\n              document.getElementById(\"smartcardInput\").style.border = \"solid green\"\n          }else{\n            //checks to know what error to display either smart card or meter number or bet number error\n            if(product_code.includes('ELECTRIC')) {\n              document.getElementById(\"err\").innerHTML = \"Invalid meter number\"\n              document.getElementById(\"smartcardInput\").style.border = \"solid red\"\n            }else if(product_code.includes('CABLE')){\n              document.getElementById(\"err\").innerHTML = \"Invalid smart card number\"\n              document.getElementById(\"smartcardInput\").style.border = \"solid red\"\n            }else{\n              document.getElementById(\"err\").innerHTML = \"Could not validate number\"\n              document.getElementById(\"smartcardInput\").style.border = \"solid red\"\n            }\n            //clears error text makes it disappear\n            setTimeout(() => {\n              document.getElementById(\"err\").innerHTML = \"\"\n            },2000)\n\n          }\n        })\n      }else{\n        //calls payment api\n        if(product_code.includes('CABLE')){\n          let price = this.productpaymentModdel.productCode.split(\" \")[0]\n          let code = this.productpaymentModdel.productCode.split(\" \")[1]\n          this.productpaymentModdel.amount = price\n          this.productpaymentModdel.productCode = code\n          this.productpaymentModdel.billerCustomerId= this.customerEnqModel.billerCustomerId\n          this.productpaymentModdel.reference = `BIZGEM-${this.reference(30)}`\n          this.productpaymentModdel.email = document.getElementById('organisationEmail').value\n        }else{\n          this.productpaymentModdel.billerCustomerId= this.customerEnqModel.billerCustomerId\n          this.productpaymentModdel.reference = `BIZGEM-${this.reference(30)}`\n          this.productpaymentModdel.email = document.getElementById('organisationEmail').value\n        }\n\n      // console.log(this.productpaymentModdel)\n      StoreUtils.dispatch(StoreUtils.actions.billspayment.updatePayment, this.productpaymentModdel).then(() => {\n        StoreUtils.dispatch(StoreUtils.actions.auth.readDashboardStats)\n      })\n      }\n    },\n    clearEnq(){\n      Object.keys(this.customerEnquiryData).forEach(key => this.customerEnquiryData[key] = null)\n    },\n    payment(){\n      if(this.products[0].productBillerCode.includes('DATA') || this.products[0].productBillerCode.includes('CABLE_TV')){\n        let price = this.productpaymentModdel.productCode.split(\" \")[0]\n        let code = this.productpaymentModdel.productCode.split(\" \")[1]\n        this.productpaymentModdel.amount = price\n        this.productpaymentModdel.productCode = code\n        this.productpaymentModdel.email = document.getElementById('organisationEmail').value\n      }else if (this.products[0].productBillerCode.includes('AIRTIME')){\n        this.productpaymentModdel.productCode = this.productCode\n      }\n      this.productpaymentModdel.reference = `BIZGEM-${this.reference(30)}`\n      this.productpaymentModdel.email = document.getElementById('organisationEmail').value\n      console.log(this.productpaymentModdel)\n      StoreUtils.dispatch(StoreUtils.actions.billspayment.updatePayment, this.productpaymentModdel).then(() => {\n        StoreUtils.dispatch(StoreUtils.actions.auth.readDashboardStats)\n      })\n    },\n    reference(length) {\n      let result = \"\"\n      let characters = 'abcdefghijklmnopgrstuvwxyzABCDEFJHIJKLMNOPQRSTUVWXYZ0123456789';\n      let charactersLength = characters.length;\n      for (var i = 0; i < length; i++) {\n        result += characters.charAt(Math.floor(Math.random() * charactersLength));\n      }\n      return result;\n    },\n  },\n  computed:{\n    ...mapState({\n      categories: state => state.billspayment.categories.data,\n      billers: state => state.billspayment.billers.data,\n      billerloading:state => state.billspayment.billersloading,\n      categoryloading:state => state.billspayment.categoriesloading,\n      products:state => state.billspayment.products.data,\n      paymentLoading:state => state.billspayment.paymentloading,\n      customerEnquiryData:state => state.billspayment.customerEnq,\n      customerEnquiryLoading: state => state.billspayment.customerEnqloading,\n      error_msg:state => state.billspayment.errorMsg,\n    }),\n\n    currentOrganisation(){\n      return StoreUtils.rootGetters(StoreUtils.getters.auth.getCurrentOrganization)\n    }\n  },\n}\n</script>\n\n<style scoped>\n.form{\n  height: auto;\n  width: 100%;\n  background-color: #FFFFFF;\n  box-shadow:0 0 1rem 0 rgb(136 152 170 / 15%);\n  border-radius: calc(0.375rem - 1px) calc(0.375rem - 1px) 0 0;\n\n}\n.card-header{\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n}\n@media (max-width: 999px) {\n  .form{\n    height: auto;\n    width: 100%;\n    background-color: #FFFFFF;\n    box-shadow:0 0 1rem 0 rgb(136 152 170 / 15%);\n    border-radius: calc(0.375rem - 1px) calc(0.375rem - 1px) 0 0;\n\n  }\n}\n</style>"]}]}